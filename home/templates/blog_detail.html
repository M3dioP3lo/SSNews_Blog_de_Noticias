{% extends 'base.html' %}

{% block title %}{{ blog.título }}{% endblock %}

{% block body %}
<div class="container mt-3">
    <h1>{{ blog.título }}</h1>
    <p>Autor: {{ blog.autor }} | Fecha: {{ blog.fecha_publicacion }}</p>
    
    <style>
        .blog-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }
    </style>
    
    {% if blog.image %}
        <img src="{{ blog.image.url }}" alt="{{ blog.título }}" class="img-fluid mb-3">
    {% endif %}
    
    <div>{{ blog.contenido|safe }}</div>

    {% if user == blog.autor %}
        <div class="mt-3">
            <a href="{% url 'edit_blog' blog.slug %}" class="btn btn-primary">Editar Blog</a>
            <a href="{% url 'delete_blog_post' blog.slug %}" class="btn btn-danger">Borrar Blog</a>
        </div>
    {% endif %}

    <h3 class="mt-4">Comentarios</h3>
    {% for comment in comments %}
        <div>
            <p>{{ comment.user.username }} - {{ comment.dateTime }}</p>
            <p>{{ comment.content }}</p>
        </div>
    {% empty %}
        <p>No hay comentarios aún.</p>
    {% endfor %}

    {% if user.is_authenticated %}
        <h4>Añadir un comentario</h4>
        <form method="post">
            {% csrf_token %}
            {{ comment_form.as_p }}
            <button type="submit" class="btn btn-primary">Enviar comentario</button>
        </form>
    {% else %}
        <p>Por favor, <a href="{% url 'login' %}">inicia sesión</a> para comentar.</p>
    {% endif %}
</div>
{% endblock %}